{% extends 'base.html' %}
{% block content %}
<div class="page-header">
  <h3 class="page-title">{{ view_bag.instance|capitalize }} Dashboard</h3>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#">Dashboards</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{ view_bag.instance|capitalize }} Dashboard</li>
    </ol>
  </nav>
</div>
<div>
  <button onclick="sendCommand('start')">Start</button>
  <button onclick="sendCommand('stop')">Stop</button>
  <button onclick="sendCommand('restart')">Restart</button>
</div>
<script>
function sendCommand(cmd) {
  fetch(`/instance/{{ view_bag.instance }}/command`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ command: cmd })
  })
  .then(response => response.json())
  .then(data => {
    alert(data.output || data.error);
  })
  .catch(err => alert("Error: " + err));
}
</script>
<div class="row ">
  <div class="col-12 grid-margin">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Order Status</h4>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th> Player ID </th>
                <th> Player Name </th>
                <th> Class  </th>
                <th> IP </th>
                <th> Model </th>
                <th> Last Connected </th>
              </tr>
            </thead>
            <tbody>
              {% for player in view_bag.players %}
              <tr>
                <td>{{ player['player_id'] }}</td>
                <td> {{ player['player'] }} </td>
                <td><div class="badge badge-outline-success">{{ player['class_name'] }}</div></td>
                <td> {{ player['ip'] }} </td>							
                <td> {{ player['model'] }} </td>
                <td> {{ player['added'] }} </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}